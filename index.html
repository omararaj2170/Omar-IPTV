<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPTV Player</title>
<style>
  body { font-family: Arial, sans-serif; background: #121212; color: #eee; padding: 20px; }
  h1 { text-align: center; color: #00ccff; }
  #container { display: flex; flex-direction: column; align-items: center; }
  #player { width: 100%; max-width: 800px; margin: 20px 0; }
  #channelList { list-style: none; padding: 0; width: 100%; max-width: 800px; }
  #channelList li { padding: 10px; border-bottom: 1px solid #333; cursor: pointer; transition: background 0.2s; }
  #channelList li:hover { background: #222; }
  a { color: inherit; text-decoration: none; }
</style>
</head>
<body>

<h1>IPTV Player</h1>

<div id="container">
  <video id="player" controls autoplay></video>
  <ul id="channelList"></ul>
</div>

<script>
const playlistURL = "playlist.m3u"; // <-- replace with your M3U/M3U8 path or URL

// Detect device (optional for styling)
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

// Fetch and parse M3U
fetch(playlistURL)
  .then(res => res.text())
  .then(text => {
    const lines = text.split(/\r?\n/);
    const channelList = document.getElementById("channelList");
    const player = document.getElementById("player");

    let currentName = "";
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();
      if (!line) continue;

      if (line.startsWith("#EXTINF:")) {
        // Grab channel name after comma
        const nameIndex = line.indexOf(",") + 1;
        currentName = line.substring(nameIndex).trim() || "Unnamed Channel";
      } else if (!line.startsWith("#")) {
        // This is the URL
        const li = document.createElement("li");
        li.textContent = currentName;
        li.dataset.url = line;
        li.addEventListener("click", () => {
          player.src = line;
          player.play();
        });
        channelList.appendChild(li);
        currentName = "";
      }
    }
  })
  .catch(err => {
    console.error("Failed to load playlist:", err);
    alert("Failed to load playlist. Check your M3U path or URL.");
  });
</script>

</body>
</html>
