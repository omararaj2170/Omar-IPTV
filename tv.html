<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Omar's IPTV â€“ TV</title>

<style>
html, body {
  margin:0;
  padding:0;
  background:black;
  color:white;
  font-family: Arial, sans-serif;
  height:100%;
  overflow:hidden;
}

/* VIDEO */
#player {
  position:fixed;
  top:0; left:0;
  width:100vw;
  height:100vh;
  background:black;
  object-fit:contain;
}

/* CAPTION */
#caption {
  position:fixed;
  bottom:60px;
  width:100%;
  text-align:center;
  font-size:22px;
  text-shadow:2px 2px 5px black;
  pointer-events:none;
}

/* MENU */
#menu {
  position:fixed;
  top:0;
  right:-420px;
  width:420px;
  height:100%;
  background:#111;
  transition:right 0.3s ease;
  overflow-y:auto;
  padding:15px;
  box-sizing:border-box;
}

#menu.open { right:0; }

#search {
  width:100%;
  padding:10px;
  font-size:18px;
  margin-bottom:10px;
  border-radius:6px;
  border:none;
}

#language {
  width:100%;
  padding:10px;
  font-size:16px;
  margin-bottom:10px;
  border-radius:6px;
  border:none;
}

#channelList {
  list-style:none;
  padding:0;
  margin:0;
}

#channelList li {
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  border-bottom:1px solid #333;
  cursor:pointer;
}

#channelList li:focus {
  outline:none;
  background:#222;
}

.logo {
  width:48px;
  height:48px;
  object-fit:contain;
  background:#000;
  border-radius:6px;
}
</style>
</head>

<body>

<video id="player" autoplay controls></video>
<div id="caption"></div>

<div id="menu">
  <input id="search" placeholder="Search channels">
  <select id="language"></select>
  <ul id="channelList"></ul>
</div>

<script>
/* ====== DATA ====== */
const playlistURL = "playlist.m3u";
const player = document.getElementById("player");
const menu = document.getElementById("menu");
const channelList = document.getElementById("channelList");
const searchInput = document.getElementById("search");
const caption = document.getElementById("caption");
const languageSelect = document.getElementById("language");

let channels = [];
let filtered = [];
let lang = "original";
const cache = {};

/* ====== LANGUAGES (HEBREW EXCLUDED) ====== */
const languages = {
  original:"ðŸŒ Original",
  af:"Afrikaans",sq:"Albanian",am:"Amharic",ar:"Arabic",hy:"Armenian",
  az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",
  bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano",zh:"Chinese",co:"Corsican",
  hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",
  eo:"Esperanto",et:"Estonian",fi:"Finnish",fr:"French",fy:"Frisian",
  gl:"Galician",ka:"Georgian",de:"German",el:"Greek",gu:"Gujarati",
  ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",hi:"Hindi",
  hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",
  ga:"Irish",it:"Italian",ja:"Japanese",jw:"Javanese",kn:"Kannada",
  kk:"Kazakh",km:"Khmer",ko:"Korean",ku:"Kurdish",ky:"Kyrgyz",
  lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",
  mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",
  mi:"Maori",mr:"Marathi",mn:"Mongolian",my:"Myanmar",ne:"Nepali",
  no:"Norwegian",ny:"Nyanja",or:"Odia",ps:"Pashto",fa:"Persian",
  pl:"Polish",pt:"Portuguese",pa:"Punjabi",ro:"Romanian",ru:"Russian",
  sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",
  sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",
  es:"Spanish",su:"Sundanese",sw:"Swahili",sv:"Swedish",tl:"Tagalog",
  tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",tr:"Turkish",
  tk:"Turkmen",uk:"Ukrainian",ur:"Urdu",ug:"Uyghur",uz:"Uzbek",
  vi:"Vietnamese",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"
};

for (const k in languages) {
  const o = document.createElement("option");
  o.value = k;
  o.textContent = languages[k];
  languageSelect.appendChild(o);
}

/* ====== TRANSLATE ====== */
async function translate(text) {
  if (lang === "original") return text;
  const key = text + lang;
  if (cache[key]) return cache[key];
  const r = await fetch(
    `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${lang}&dt=t&q=${encodeURIComponent(text)}`
  );
  const d = await r.json();
  cache[key] = d[0][0][0];
  return cache[key];
}

/* ====== LOAD PLAYLIST ====== */
fetch(playlistURL).then(r=>r.text()).then(t=>{
  const lines = t.split(/\r?\n/);
  let c = {};
  lines.forEach(l=>{
    if (l.startsWith("#EXTINF")) {
      c = {};
      c.name = l.split(",").pop();
      const logo = l.match(/tvg-logo="([^"]+)"/);
      c.logo = logo ? logo[1] : "";
    } else if (l && !l.startsWith("#")) {
      c.url = l;
      channels.push(c);
    }
  });
  filtered = channels;
  render();
});

/* ====== RENDER ====== */
async function render() {
  channelList.innerHTML = "";
  for (const ch of filtered) {
    const li = document.createElement("li");
    li.tabIndex = 0;

    const img = document.createElement("img");
    img.src = ch.logo || "https://via.placeholder.com/48?text=TV";
    img.className = "logo";

    const name = document.createElement("span");
    name.textContent = await translate(ch.name);

    li.append(img, name);

    li.onclick = async ()=>{
      player.src = ch.url;
      player.play();
      caption.textContent = await translate(ch.name);
      menu.classList.remove("open");
    };

    channelList.appendChild(li);
  }
}

/* ====== SEARCH ====== */
searchInput.oninput = ()=>{
  const q = searchInput.value.toLowerCase();
  filtered = channels.filter(c=>c.name.toLowerCase().includes(q));
  render();
};

languageSelect.onchange = ()=>{
  lang = languageSelect.value;
  render();
};

/* ====== REMOTE CONTROLS ====== */
document.addEventListener("keydown", e=>{
  if (e.key === "ArrowRight") menu.classList.add("open");
  if (e.key === "ArrowLeft") menu.classList.remove("open");
});
</script>

</body>
</html>